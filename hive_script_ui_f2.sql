use itemRecommend;
drop table if exists ui_f2;
create table ui_f2 as select user_id as ui_user_id2,item_id as ui_item_id2,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=24) then 1 else 0 end) as ui39,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=23) then 1 else 0 end) as ui40,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=22) then 1 else 0 end) as ui41,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=21) then 1 else 0 end) as ui42,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=20) then 1 else 0 end) as ui43,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=19) then 1 else 0 end) as ui44,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=18) then 1 else 0 end) as ui45,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=17) then 1 else 0 end) as ui46,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=16) then 1 else 0 end) as ui47,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=15) then 1 else 0 end) as ui48,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=14) then 1 else 0 end) as ui49,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=13) then 1 else 0 end) as ui50,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=12) then 1 else 0 end) as ui51,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=11) then 1 else 0 end) as ui52,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=10) then 1 else 0 end) as ui53,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=9) then 1 else 0 end) as ui54,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=8) then 1 else 0 end) as ui56,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=7) then 1 else 0 end) as ui57,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=6) then 1 else 0 end) as ui58,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=5) then 1 else 0 end) as ui59,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=4) then 1 else 0 end) as ui60,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=3) then 1 else 0 end) as ui61,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=2) then 1 else 0 end) as ui62,
sum(case when (behavior_type=1 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=1) then 1 else 0 end) as ui63,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=24) then 1 else 0 end) as ui64,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=23) then 1 else 0 end) as ui65,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=22) then 1 else 0 end) as ui66,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=21) then 1 else 0 end) as ui67,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=20) then 1 else 0 end) as ui68,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=19) then 1 else 0 end) as ui69,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=18) then 1 else 0 end) as ui70,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=17) then 1 else 0 end) as ui71,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=16) then 1 else 0 end) as ui72,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=15) then 1 else 0 end) as ui73,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=14) then 1 else 0 end) as ui74,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=13) then 1 else 0 end) as ui75,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=12) then 1 else 0 end) as ui76,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=11) then 1 else 0 end) as ui77,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=10) then 1 else 0 end) as ui78,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=9) then 1 else 0 end) as ui79,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=8) then 1 else 0 end) as ui80,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=7) then 1 else 0 end) as ui81,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=6) then 1 else 0 end) as ui82,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=5) then 1 else 0 end) as ui83,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=4) then 1 else 0 end) as ui84,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=3) then 1 else 0 end) as ui85,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=2) then 1 else 0 end) as ui86,
sum(case when (behavior_type=2 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=1) then 1 else 0 end) as ui87,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=24) then 1 else 0 end) as ui88,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=23) then 1 else 0 end) as ui89,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=22) then 1 else 0 end) as ui90,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=21) then 1 else 0 end) as ui91,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=20) then 1 else 0 end) as ui92,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=19) then 1 else 0 end) as ui93,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=18) then 1 else 0 end) as ui94,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=17) then 1 else 0 end) as ui95,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=16) then 1 else 0 end) as ui96,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=15) then 1 else 0 end) as ui97,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=14) then 1 else 0 end) as ui98,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=13) then 1 else 0 end) as ui99,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=12) then 1 else 0 end) as ui100,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=11) then 1 else 0 end) as ui101,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=10) then 1 else 0 end) as ui102,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=9) then 1 else 0 end) as ui103,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=8) then 1 else 0 end) as ui104,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=7) then 1 else 0 end) as ui105,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=6) then 1 else 0 end) as ui106,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=5) then 1 else 0 end) as ui107,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=4) then 1 else 0 end) as ui108,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=3) then 1 else 0 end) as ui109,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=2) then 1 else 0 end) as ui110,
sum(case when (behavior_type=3 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=1) then 1 else 0 end) as ui111,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=17) then 1 else 0 end) as ui119,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=16) then 1 else 0 end) as ui120,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=15) then 1 else 0 end) as ui121,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=14) then 1 else 0 end) as ui122,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=13) then 1 else 0 end) as ui123,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=12) then 1 else 0 end) as ui124,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=11) then 1 else 0 end) as ui125,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=10) then 1 else 0 end) as ui126,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=9) then 1 else 0 end) as ui127,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=8) then 1 else 0 end) as ui128,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=7) then 1 else 0 end) as ui129,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=6) then 1 else 0 end) as ui130,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=5) then 1 else 0 end) as ui131,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=4) then 1 else 0 end) as ui132,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=3) then 1 else 0 end) as ui133,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=2) then 1 else 0 end) as ui134,
sum(case when (behavior_type=4 and (cast(substr(time,-2,2) as int)-cast(substr('${hiveconf:feature_time}',-2,2) as int))=1) then 1 else 0 end) as ui135 
from train_user where datediff(substr('${hiveconf:feature_time}',0,10),substr(time,0,10))=1 group by user_id,item_id;
